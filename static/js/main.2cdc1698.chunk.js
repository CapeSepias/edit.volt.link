(this["webpackJsonpedit.volt.link"]=this["webpackJsonpedit.volt.link"]||[]).push([[0],{114:function(e,t,n){var r=n(84).negotiateLanguages;function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["en"],n=Object.keys(e);if(0===n.length)return null;var a=r(t,n,{defaultLocale:n[0],strategy:"lookup"});return 0===a.length?null:e[a[0]]}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["en"],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"locale",a=e.map((function(e){return e[n]})).filter(Boolean);if(0===a.length)return null;var c=r(t,a,{defaultLocale:a[0],strategy:"lookup"});return 0===c.length?null:e.filter((function(e){return e[n]===c[0]}))}e.exports={fluentByObject:a,fluentByArray:c,fluentByAny:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["en"],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(Array.isArray(e)){var r=c(e,t);Array.isArray(r)&&r.length>0&&(e=r[0].value)}else"object"===typeof e&&(e=a(e,t));return"string"!==typeof e&&(e=n),e}}},125:function(e,t,n){e.exports={header:"Header_header__3mObx",headerBar:"Header_headerBar__2YU41",notificationBanner:"Header_notificationBanner__104SP"}},128:function(e,t,n){e.exports={coverphoto:"CoverphotoPicker_coverphoto__1mWB4",no_image:"CoverphotoPicker_no_image__2DoZu"}},147:function(e,t,n){e.exports={input:"Shortcode_input__Av6rm",hideSubmitButton:"Shortcode_hideSubmitButton__mbXgB"}},149:function(e,t,n){e.exports={translatedInput:"TranslatedInput_translatedInput__2vy_n",content:"TranslatedInput_content__2-c_U",translationHelp:"TranslatedInput_translationHelp__2_0uC",changeLocaleButton:"TranslatedInput_changeLocaleButton__19h6P"}},151:function(e,t,n){e.exports={rebuild_textarea:"HtmlInput_rebuild_textarea__ZfRzZ",show_placeholder:"HtmlInput_show_placeholder__hM8g2"}},162:function(e,t,n){e.exports={app:"App_app__3hbGO"}},165:function(e,t,n){e.exports={error:"FancyInput_error__2DFWE"}},166:function(e,t,n){e.exports={editor:"Editor_editor__2hX0g",loadingContent:"Editor_loadingContent__2fqdK",editor_form_row:"Editor_editor_form_row__17Pul"}},190:function(e,t,n){},211:function(e,t,n){var r={"./de.ftl":[220,3],"./en.ftl":[221,4],"./fr.ftl":[222,5]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=211,e.exports=a},212:function(e,t,n){"use strict";n.r(t);var r=n(21),a=n(6),c=n(0),o=n.n(c),i=n(34),s=n.n(i),l=(n(190),n(162)),u=n.n(l),d=n(30),j=n(324),b=n(332),p=n(326),h=n(281),O=n(328),f=n(308),x=n(309),v=n(310),m=n(311),g=n(312),_=n(5),y=n(94),k=n(84),w=n(63),C=n(114),F=n.n(C),N=n(1),S=function(e){return Object(N.jsx)(y.b,Object(_.a)(Object(_.a)({},e),{},{elems:Object(_.a)({br:Object(N.jsx)("br",{})},e.elems),children:Object(N.jsx)(o.a.Fragment,{children:e.children})}),e.id)};function I(e){return function(t){var n=o.a.useContext(w.a);return o.a.createElement(e,Object(_.a)({fluentByObject:function(e,t){if(t||(t=null),e){var a,c=n.supportedLocales||[],o=Object.keys(e).filter((function(e){return c.includes(e)})),i=Object(k.negotiateLanguages)(n.userLocales,o,{defaultLocale:n.defaultLocale}),s=Object(r.a)(i);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(e[l])return e[l]}}catch(u){s.e(u)}finally{s.f()}return t}return t},getString:function(e,t,r){return n.getString(e,t,r||" ")}},t))}}function E(){var e=o.a.useContext(w.a);return Object(_.a)(Object(_.a)({},e),{},{getString:function(t,n,r){return e.getString(t,n,r||" ")},fluentByAny:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return F.a.fluentByAny(t,e.userLocales,n)}})}function B(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(c.useState)({}),n=Object(a.a)(t,2),r=n[0],o=n[1],i=Object(c.useState)(!1),s=Object(a.a)(i,2),l=s[0],u=s[1];return Object(c.useEffect)((function(){!0!==e&&window.hasOwnProperty("useUser_user")&&window.hasOwnProperty("useUser_loggedIn")?(o(window.useUser_user),u(window.useUser_loggedIn)):fetch("".concat(window.domains.backend,"user.json"),{mode:"cors",credentials:"include"}).then((function(e){return e.json()})).then((function(e){e&&e.user&&e.user.id&&e.user.status?(e.user.username=(e.user.email&&e.user.email||"").split("@")[0],window.useUser_user=e.user,window.useUser_loggedIn=!0,o(e.user),u(!0)):(window.useUser_user={},window.useUser_loggedIn=!1,o({}),u(!1))})).catch((function(e){return console.error(e)}))}),[e,o,u]),Object(_.a)(Object(_.a)({},r),{},{loggedIn:l})}var A,D,T,P,L,R=n(16),H=n.n(R),M=n(28),V=n(273),W=n(274),G=n(275),U=n(272),z=n(58),q=n(323),Z=Object(q.a)(A||(A=Object(z.a)(["\n  query getBlock ($_id: ID!) {\n    block (_id: $_id) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n      }\n\t\t  parent\n\t\t  metadata {\n        lastModified\n        created\n      }\n    }\n  }\n"]))),$=(Object(q.a)(D||(D=Object(z.a)(["\n  query getBlockBySlug ($slug: ID!) {\n    blockBySlug (slug: $slug) {\n\t\t  _id\n\t\t  type\n\t\t  properties\n\t\t  content {\n        blockId\n      }\n\t\t  parent\n\t\t  metadata {\n        lastModified\n        created\n      }\n      permissions {\n        email\n        role\n      }\n    }\n  }\n"]))),Object(q.a)(T||(T=Object(z.a)(["\n  query getBlocksByType ($type: String!) {\n    blocksByType (type: $type) {\n      _id\n      type\n      properties\n      content {\n        blockId\n      }\n      parent\n      metadata {\n        lastModified\n        created\n      }\n    }\n  }\n"])))),J=Object(q.a)(P||(P=Object(z.a)(["\n  query getBlocksByIds ($ids: [ID]) {\n    blocksByIds(ids: $ids) {\n      _id\n      type\n      properties\n    \tcontent {\n      \tblockId\n    \t}\n      parent\n      metadata {\n        lastModified\n        created\n      }\n    }\n  }\n"]))),K=Object(q.a)(L||(L=Object(z.a)(["\n  mutation saveBlock ($block: InputBlock!) {\n    saveBlock (block: $block)\n  }\n"]))),X=n(90);var Q=function(){var e=E().getString,t=Object(U.a)(),n=Object(X.b)(),r=n.enqueueSnackbar,a=n.closeSnackbar;return Object(c.useCallback)((function(n){return new Promise((function(c){var o=null;"object"===typeof(n=Object(_.a)({},n))&&null!==n&&n.hasOwnProperty("__typename")&&delete n.__typename;var i=new Promise((function(i){t.mutate({mutation:K,variables:{block:n}}).then(function(){var t=Object(M.a)(H.a.mark((function t(s){var l;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=s.data,i("got-data"),null!==o&&a(o),"string"===typeof l.error?"no_edit_permission"===l.error?r(e("path_editor_edit_permission_error"),{variant:"error",preventDuplicate:!0,autoHideDuration:2e3}):r(""+l.error,{variant:"error",preventDuplicate:!0,autoHideDuration:2e3}):(c(Object(_.a)(Object(_.a)({},n),{},{_id:l.saveBlock})),r(e("path_editor_status_saved"),{variant:"success",preventDuplicate:!1,autoHideDuration:2e3}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch(function(){var t=Object(M.a)(H.a.mark((function t(n){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.error(n),i("got-error"),null!==o&&a(o),r(e("path_editor_status_error_while_saving",{error:n.message}),{variant:"error",preventDuplicate:!0,autoHideDuration:2e3});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}));Promise.race([new Promise((function(e){setTimeout((function(){e("show-loading")}),300)})),i]).then((function(t){"show-loading"===t&&(o=r(e("path_editor_status_started_saving"),{persist:!0,preventDuplicate:!0}))})).catch((function(e){return console.error}))}))}),[r,a,t,e])},Y=n(50),ee=n(125),te=n.n(ee);function ne(e){var t=e.title,n=e.leftActions,r=e.rightActions,a=e.notificationBanner;return Object(N.jsxs)("header",{className:te.a.header,children:[Object(N.jsxs)("div",{className:te.a.headerBar,children:[n,Object(N.jsx)("h2",{children:t}),r]}),a?Object(N.jsx)("div",{className:te.a.notificationBanner,children:a}):null]})}var re=function(e){var t=e.ariaLabel,n=e.items,r=e.defaultValue,o=e.onChange,i=e.style,s=e.className,l=Object(c.useState)(),u=Object(a.a)(l,2),d=u[0],j=u[1];Object(c.useEffect)((function(){return j(r)}),[r,j]);var b=Object(c.useCallback)((function(e){var t=e.target.dataset.value;j(t),o&&o(t)}),[j,o]);return Object(N.jsx)("div",{"aria-label":t,className:"buttonRow "+(s||""),style:Object(_.a)({display:"inline-block"},i),children:n.map((function(e){var t=e.value,n=e.title,r=e.icon||null;return Object(N.jsx)("button",{className:"".concat(d===t?"choosen":""," ").concat(r?"hasIcon":""),onClick:b,"data-value":t,children:Object(N.jsxs)("span",{style:{pointerEvents:"none"},children:[r||null,n?Object(N.jsx)("span",{style:{verticalAlign:"middle"},children:n}):null]})},t+"_"+n)}))})};var ae=function(e){var t=e.leftHeaderActions,n=e.rightHeaderActions,r=E(),o=r.getString,i=r.fluentByAny,s=Object(U.a)(),l=Object(c.useState)("page"),u=Object(a.a)(l,2),j=u[0],b=u[1],p=Object(c.useState)([]),h=Object(a.a)(p,2),O=h[0],f=h[1],x=Q(),v=B().editable||[],m=Object(d.f)(),g=Object(c.useCallback)((function(e){s.query({query:$,variables:{type:e}}).then(function(){var e=Object(M.a)(H.a.mark((function e(t){var n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"string"!==typeof(n=t.data).error&&n.blocksByType?f(n.blocksByType||[]):console.error("error",n.error);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=Object(M.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error("error",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[s,f]);Object(c.useEffect)((function(){g(j)}),[g,j]);var _=Object(c.useCallback)((function(e){b(e),"string"===typeof e&&""!==e&&e!==j&&g(e)}),[j,b,g]),y=Object(c.useCallback)((function(){x({type:j}).then((function(e){m.push("/edit/".concat(e._id))})).catch((function(e){console.error(e)}))}),[x,m,j]);return Object(N.jsxs)("div",{children:[Object(N.jsx)(ne,{title:"volt.link",leftActions:t||null,rightActions:n||null}),Object(N.jsx)(re,{onChange:_,defaultValue:j,items:[{value:"page",icon:Object(N.jsx)(V.a,{className:"icon"}),title:o("block_menu_type_label_page")},{value:"redirect",icon:Object(N.jsx)(W.a,{className:"icon"}),title:o("block_menu_type_label_redirect")},{value:"person",icon:Object(N.jsx)(G.a,{className:"icon"}),title:o("block_menu_type_label_person")}]}),Object(N.jsx)("br",{}),Object(N.jsx)("br",{}),Object(N.jsx)("button",{className:"green",onClick:y,style:{margin:"0"},children:Object(N.jsx)(S,{id:"create_new_"+j})}),v.length>0?Object(N.jsx)(N.Fragment,{children:Object(N.jsx)("div",{className:"buttonRow usesLinks",children:O.map((function(e){var t=i(e.properties.text,o("placeholder_main_headline")),n=i(e.properties.description,"");return Object(N.jsxs)("div",{children:[Object(N.jsx)("hr",{}),""!==t?Object(N.jsx)("h2",{children:t}):null,""!==n?Object(N.jsx)("p",{children:n}):null,Object(N.jsx)(Y.b,{to:"/edit/".concat(e._id),children:Object(N.jsx)("button",{children:Object(N.jsx)(S,{id:"edit_block"})})}),Object(N.jsx)(Y.b,{to:"/view/".concat(e._id),children:Object(N.jsx)("button",{children:Object(N.jsx)(S,{id:"view_block"})})})]},e._id)}))})}):null]})},ce=n(147),oe=n.n(ce);var ie=/^([\+-\.0-9A-Z\u017F\u212A]+:(?:\/\/)?)[\x2D\.0-9A-Z_a-z\xC0-\xFF\u017F\u1E9E\u212A\u212B]+(?:\.[\x2D\.0-9A-Z_a-z\xC0-\xFF\u017F\u1E9E\u212A\u212B]+)+[!#-;=\?-\[\]_a-z~\xC0-\xFF\u017F\u1E9E\u212A\u212B]+$/gi,se=/^(?:(?:(?:(?![\t-\r "\(\),\.:-<>@\[-\]\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+(?:\.(?:(?![\t-\r "\(\),\.:-<>@\[-\]\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+)*)|(?:"(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+"))@(?:(?:\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})|(?:(?:[\x2D0-9A-Za-z\u017F\u212A]+\.)+[A-Za-z\u017F\u212A]{2,})\.?)$/gi,le=/^(?:(?![\/:])[\s\S])+@(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/gi;var ue=function(e){var t=e.defaultValue,n=void 0===t?"":t,r=e.onChange,o=e.onBlur,i=e.onError,s=e.placeholder,l=void 0===s?"https://":s,u=e.style,d=e.className,j=Object(c.useState)(n),b=Object(a.a)(j,2),p=b[0],h=b[1],O=Object(c.useCallback)((function(e){var t=e.target.value||"",n="";if(""!==t){var a=t.split(":"),c=a.shift(),o=a.join(":");"tel"===c||("mailto"===c||t.match(le)?o.match(se)||(n="invalid_mailto_url"):t.match(ie)||(n="invalid_url"))}r&&r(t),i&&i(n),h(t)}),[r,i]),f=Object(c.useCallback)((function(){o&&o(p)}),[o,p]);return Object(N.jsx)("input",{type:"url",onChange:O,onBlur:f,defaultValue:n,placeholder:l,style:u,className:d})},de=n(46),je=n(165),be=n.n(je),pe=["children","className","style"];var he=function(e){var t=e.children,n=e.className,r=e.style,o=(Object(de.a)(e,pe),Object(c.useState)("")),i=Object(a.a)(o,2),s=i[0],l=i[1];return Object(N.jsxs)("div",{className:n,style:r,children:[t({setError:l}),s?Object(N.jsx)("div",{className:be.a.error,children:Object(N.jsx)(S,{id:"error_"+s})}):null]})};var Oe=I((function(e){var t,n,r=e.getString,o=e.rightHeaderActions,i=Object(d.f)(),s=Object(c.useState)(""),l=Object(a.a)(s,2),u=l[0],j=l[1],b=Object(c.useState)(!1),p=Object(a.a)(b,2),h=p[0],O=p[1],f=Object(c.useState)(""),x=Object(a.a)(f,2),v=x[0],m=x[1];t=["Enter"],n=function(){h&&_()},Object(c.useEffect)((function(){function e(e){t.includes(e.key)&&n(e)}return window.addEventListener("keyup",e),function(){return window.removeEventListener("keyup",e)}}),[t,n]);var g=Object(c.useCallback)((function(e){j(e),O(""!==e)}),[j,O]),_=Object(c.useCallback)((function(){if(h){var e={use_as:"redirect",redirect:u};fetch("".concat(window.domains.backend,"set_redirect"),{mode:"cors",credentials:"include",method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then(function(){var e=Object(M.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"string"===typeof t.error?(console.error(t.error),m(t.error)):"string"===typeof t.code?i.push("/edit/".concat(t.code)):m("Undefined Error. Please contact thomas.rosen@volteuropa.org");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=Object(M.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error(t),m(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),[h,u,i]);return Object(N.jsxs)("div",{children:[Object(N.jsx)(ne,{title:Object(N.jsx)(S,{id:"create_shortcode_headline"}),rightActions:o||null}),Object(N.jsx)("p",{children:Object(N.jsx)(S,{id:"create_shortcode_info"})}),Object(N.jsxs)("div",{className:"".concat(oe.a.input," ").concat(!0===h?"":oe.a.hideSubmitButton),children:[Object(N.jsx)(he,{style:{flexGrow:"1",display:"flex",flexDirection:"column"},children:function(e){var t=e.setError;return Object(N.jsx)(ue,{onError:t,placeholder:r("create_shortcode_url_placeholder"),onChange:g})}}),!0===h?Object(N.jsx)("button",{className:"green",onClick:_,children:Object(N.jsx)(S,{id:"create_shortcode_url_submit"})}):null]}),""!==v?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("h3",{className:"red",children:Object(N.jsx)(S,{id:"headline_errors"})}),Object(N.jsx)("p",{children:v})]}):null]})}));var fe=function(){var e=E().getString,t=Object(U.a)(),n=Object(X.b)(),r=n.enqueueSnackbar,a=n.closeSnackbar;return Object(c.useCallback)((function(n){return new Promise((function(c){var o=null;if(n&&""!==n){var i=new Promise((function(i){t.query({query:Z,variables:{_id:n}}).then(function(){var t=Object(M.a)(H.a.mark((function t(n){var s,l;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=n.data,i("got-data"),null!==o&&a(o),"string"!==typeof s.error&&s.block?(l=s.block,c(l)):"no_edit_permission"===s.error?r(e("path_editor_edit_permission_error"),{variant:"error",preventDuplicate:!0,autoHideDuration:5e3}):r(""+s.error,{variant:"error",preventDuplicate:!0,autoHideDuration:5e3});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch(function(){var e=Object(M.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error("error",t),i("got-error"),null!==o&&a(o),r("[could not load data] "+t.message,{variant:"error",preventDuplicate:!0,autoHideDuration:2e3});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));Promise.race([new Promise((function(e){setTimeout((function(){e("show-loading")}),300)})),i]).then((function(t){"show-loading"===t&&(o=r(e("path_editor_status_started_saving"),{persist:!0,preventDuplicate:!0}))})).catch((function(e){return console.error}))}else c({type:"text"})}))}),[r,a,t,e])},xe=n(301),ve=n(302),me=n(303),ge=n(304),_e=n(305),ye=n(306),ke=n(166),we=n.n(ke),Ce=n(18),Fe=n(330),Ne=n(331),Se=n(333),Ie=n(334),Ee=n(280),Be=n(282),Ae=n(283),De=n(284),Te=n(276),Pe=n(318),Le=n(277);var Re=function(e){var t,n,r=e.trigger,o=e.children,i=void 0===o?function(){}:o,s=Object(c.useRef)(null),l=Object(c.useState)(!1),u=Object(a.a)(l,2),d=u[0],j=u[1],b=Object(c.useRef)(null);t=b,n=function(){j(!1)},Object(c.useEffect)((function(){var e=function(e){t.current&&!t.current.contains(e.target)&&n(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),function(){document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[t,n]);var p=function(){j(!1)},h=d?"popover-"+(Math.random()+1).toString(36).substring(7):void 0;return Object(N.jsxs)(N.Fragment,{children:[r({ref:s,"aria-describedby":h,onClick:function(e){j((function(e){return!e}))}}),Object(N.jsxs)(Te.a,{children:[Object(N.jsx)("div",{style:{display:d?"block":"none",position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:1e3,cursor:"pointer"}}),Object(N.jsx)(Pe.a,{id:h,open:d,anchorEl:s.current,transition:!0,placement:"bottom-start",disablePortal:!0,modifiers:[{name:"flip",enabled:!0,options:{altBoundary:!0,rootBoundary:"viewport",padding:8}},{name:"preventOverflow",enabled:!0,options:{altAxis:!0,altBoundary:!0,tether:!0,rootBoundary:"viewport",padding:8}}],style:{zIndex:1e3},children:function(e){var t=e.TransitionProps;return Object(N.jsx)(Le.a,Object(_.a)(Object(_.a)({},t),{},{children:Object(N.jsx)("div",{children:i&&"function"===typeof i?i({ref:b,style:{transformOrigin:"top left"},closePopover:p}):null})}))}})]})]})},He=n(149),Me=n.n(He),Ve=["closePopover"],We=Object(c.createContext)({locale:"en",showTranslations:!1});function Ge(e){var t=e.children,n=E(),r=n.userLocales,o=void 0===r?[]:r,i=n.supportedLocales,s=void 0===i?[]:i,l=n.defaultLocale,u=void 0===l?"en":l,d=Object(c.useCallback)((function(e){var t=Object(C.fluentByArray)(e,o,"locale");return Array.isArray(t)?t:[]}),[o]),j=Object(c.useState)(!1),b=Object(a.a)(j,2),p=b[0],h=b[1],O=Object(c.useCallback)((function(){h((function(e){return!e}))}),[h]),f=Object(c.useState)(o[0]||s[0]||u),x=Object(a.a)(f,2),v=x[0],m=x[1],g=Object(c.useCallback)((function(e){m(e),h(!0)}),[m,h]);return Object(N.jsx)(We.Provider,{value:{currentLocale:v,setCurrentLocale:g,locales:s,filterByLocale:d,showTranslations:p,toggleShowTranslations:O},children:t})}function Ue(){return Object(c.useContext)(We)}function ze(e){var t=e.trigger,n=E().getString,r=!1;window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(r=!0);var a=Ue(),o=a.currentLocale,i=a.setCurrentLocale,s=a.showTranslations,l=a.toggleShowTranslations,u=E().supportedLocales,d=void 0===u?[]:u,j=Object(c.useCallback)((function(e){"function"===typeof i&&i(e)}),[i]);return Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(Re,{trigger:t,children:function(e){var t=e.closePopover,a=Object(de.a)(e,Ve);return Object(N.jsx)(Fe.a,Object(_.a)(Object(_.a)({},a),{},{sx:{maxWidth:380,height:"auto",maxHeight:"calc(100vh - 32px)",overflow:"auto"},elevation:8,children:Object(N.jsxs)(Ne.a,{autoFocus:!0,style:{width:"100%",maxWidth:"100%",marginTop:"-8px"},children:[Object(N.jsxs)(b.a,{style:{width:"100%",maxWidth:"100%",marginTop:"-8px"},children:[Object(N.jsx)(Se.a,{style:{whiteSpace:"nowrap",lineHeight:"1",margin:"-4px 0 0 0",padding:"12px 16px 12px",backgroundColor:r?"#2e2e2e":"#fff"},children:Object(N.jsx)(S,{id:"locale_menu_choose_locale_label"})}),Object(N.jsx)("div",{style:{height:"4px"}}),d.map((function(e,t){return Object(N.jsx)(Ie.a,{selected:e===o,onClick:function(){return j(e)},children:n("locale_"+e)},e)}))]}),Object(N.jsx)(Ee.a,{style:{opacity:.2}}),Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:l,children:[Object(N.jsx)(h.a,{children:s?Object(N.jsx)(Be.a,{}):Object(N.jsx)(Ae.a,{})}),Object(N.jsx)(O.a,{children:s?Object(N.jsx)(S,{id:"locale_menu_hide_translation_help_label"}):Object(N.jsx)(S,{id:"locale_menu_show_translation_help_label"})})]}),Object(N.jsx)(Ee.a,{style:{opacity:.2}}),Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:t,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(De.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(S,{id:"block_menu_close_menu"})})]})]})}))}})})}function qe(e){var t=e.defaultValue,n=e.onChange,r=e.onBlur,o=e.children,i=void 0===o?null:o,s=Object(c.useState)([]),l=Object(a.a)(s,2),u=l[0],d=l[1];Object(c.useEffect)((function(){Array.isArray(t)?d(t):d([])}),[t,d]);var j=Ue(),b=j.currentLocale,p=j.filterByLocale,h=j.showTranslations,O=Object(Ce.a)(u).filter((function(e){return e.locale===b}));O=O.length>0?O[0].value:"";var f=Object(c.useCallback)((function(e){var t=Object(Ce.a)(u);t=u.length>0?t.findIndex((function(e){return e.locale===b}))>-1?t.map((function(t){return t.locale===b?Object(_.a)(Object(_.a)({},t),{},{value:e}):t})).filter((function(e){return""!==e.value})):[].concat(Object(Ce.a)(t),[{locale:b,value:e}]).filter((function(e){return""!==e.value})):[{locale:b,value:e}],d(t),n&&n(t)}),[d,u,b,n]),x=Object(c.useCallback)((function(){r&&r(u)}),[r,u]),v=p(u.filter((function(e){return e.locale!==b})));return"function"===typeof i?Object(N.jsxs)("div",{className:Me.a.translatedInput,children:[Object(N.jsx)("div",{style:{flexGrow:"1",width:"100%"},children:i({key:b,defaultValue:O,onChange:f,onBlur:x})}),!0===h&&v.length>0?Object(N.jsx)("div",{className:Me.a.translationHelp,children:v.map((function(e){return Object(N.jsxs)("p",{children:[Object(N.jsxs)("strong",{children:[e.locale.toUpperCase(),":"]})," ",e.value]},e.locale)}))}):null]}):null}var Ze=n(285),$e=n(286),Je=n(287),Ke=n(288),Xe=n(289),Qe=n(290),Ye=n(291),et=n(292),tt=n(293),nt=["closePopover"];var rt=I((function(e){var t=e.block,n=e.getString,r=e.trigger,a=e.setType,o=e.toggle_active,i=void 0===o?null:o,s=e.active,l=void 0===s?null:s,u=e.onRemoveRow,j=void 0===u?null:u,p=e.addRowBefore,f=void 0===p?null:p,x=e.addRowAfter,v=void 0===x?null:x,m=!1;window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(m=!0);var g=Object(d.f)(),y=t._id,k=void 0===y?"":y,w=t.type,C=void 0===w?"":w,F=Object(c.useCallback)((function(){f({blockId:""})}),[f]),I=Object(c.useCallback)((function(){g.push("/view/".concat(k))}),[k,g]);return Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(Re,{trigger:r,children:function(e){var t=e.closePopover,r=Object(de.a)(e,nt);return Object(N.jsx)(Fe.a,Object(_.a)(Object(_.a)({},r),{},{sx:{maxWidth:380,height:325,maxHeight:"calc(100vh - 32px)",overflow:"auto"},elevation:8,children:Object(N.jsxs)(Ne.a,{autoFocus:!0,style:{width:"100%",maxWidth:"100%",marginTop:"-8px"},children:[Object(N.jsxs)(b.a,{style:{width:"100%",maxWidth:"100%",marginTop:"-8px"},children:[Object(N.jsx)(Se.a,{style:{whiteSpace:"nowrap",lineHeight:"1",margin:"-4px 0 0 0",padding:"12px 16px 12px",backgroundColor:m?"#2e2e2e":"#fff"},children:Object(N.jsx)(S,{id:"block_menu_choose_type_label"})}),Object(N.jsx)("div",{style:{height:"4px"}}),[{value:"page",icon:Object(N.jsx)(V.a,{}),label:n("block_menu_type_label_page")},{value:"person",icon:Object(N.jsx)(G.a,{}),label:n("block_menu_type_label_person")},{value:"button",icon:Object(N.jsx)(Ze.a,{}),label:n("block_menu_type_label_button")},{value:"headline",icon:Object(N.jsx)($e.a,{}),label:n("block_menu_type_label_headline")},{value:"text",icon:Object(N.jsx)(Je.a,{}),label:n("block_menu_type_label_text")},{value:"divider",icon:Object(N.jsx)(Ke.a,{}),label:n("block_menu_type_label_divider")}].map((function(e){return Object(N.jsxs)(Ie.a,{selected:e.value===C,onClick:function(){return a(e.value)},children:[Object(N.jsx)(h.a,{children:e.icon}),Object(N.jsx)(O.a,{children:e.label})]},e.value)}))]}),f||v||"boolean"===typeof l&&i||j?Object(N.jsx)(Ee.a,{style:{opacity:.2}}):null,f?Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:F,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(Xe.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(S,{id:"block_menu_add_before"})})]}):null,v?Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:v,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(Qe.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(S,{id:"block_menu_add_after"})})]}):null,"boolean"===typeof l&&i?Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:i,children:[Object(N.jsx)(h.a,{children:l?Object(N.jsx)(Be.a,{}):Object(N.jsx)(Ae.a,{})}),Object(N.jsx)(O.a,{children:l?Object(N.jsx)(S,{id:"block_menu_hide"}):Object(N.jsx)(S,{id:"block_menu_show"})})]}):null,j?Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:j,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(Ye.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(S,{id:"block_menu_delete"})})]}):null,"string"===typeof k&&""!==k?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Ee.a,{style:{opacity:.2}}),Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:I,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(et.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(S,{id:"view_block"})})]})]}):null,Object(N.jsx)(Ee.a,{style:{opacity:.2}}),Object(N.jsxs)(Ie.a,{style:{marginTop:"8px"},onClick:t,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(tt.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(S,{id:"block_menu_close_menu"})})]})]})}))}})})})),at=n(322),ct=n(295),ot=n(296),it=n(297),st=n(95),lt=n.n(st),ut=n(150),dt=n(151),jt=n.n(dt),bt=["defaultValue","children","className","onChange","onBlur","onError","linebreaks","style","placeholder","onInputRef","onGoToPrevInput","onGoToNextInput","onSplitText","onMergeToPrevInput","onMergeToNextInput"];function pt(e,t){if(e.normalize(),!window.getSelection)return 0;var n=window.getSelection(),r=n.rangeCount>0?n.getRangeAt(0):null;if(!r)return 0;var a=r.cloneRange();a.selectNodeContents(e),a.setEnd(r.endContainer,r.endOffset);var c=a.cloneContents(),o=0;return c.childNodes.length>0&&("first"===t?o=3===c.childNodes[0].nodeType?c.childNodes[0].length:0:"last"===t&&(o=3===c.childNodes[c.childNodes.length-1].nodeType?c.childNodes[c.childNodes.length-1].length:c.childNodes.length>1&&3===c.childNodes[c.childNodes.length-2].nodeType?c.childNodes[c.childNodes.length-2].length:0)),a.detach(),o}function ht(e){var t=getComputedStyle(e),n=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),a=parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),c=e.offsetHeight-n-a,o=Object(ut.a)(e),i=Object(ut.b)(e);i.top=i.top-o.top,i.left=i.left-o.left;var s=i.top<i.height,l=c-i.top<i.height,u=function(e){if(e.normalize(),!window.getSelection)return 0;var t=window.getSelection(),n=t.rangeCount>0?t.getRangeAt(0):null;if(!n)return 0;var a=n.cloneRange();a.selectNodeContents(e),a.setEnd(n.endContainer,n.endOffset);var c,o=a.cloneContents(),i=0,s=Object(r.a)(o.childNodes);try{for(s.s();!(c=s.n()).done;){var l=c.value;3===l.nodeType?i+=l.textContent.length:1===l.nodeType&&"BR"===l.nodeName&&(i+=1)}}catch(u){s.e(u)}finally{s.f()}return a.detach(),i}(e),d=e.innerText.length||0;d<0&&(d=0);var j=d-u;return{inFirstLine:s,inLastLine:l,left:i.left,top:i.top,height:i.height,positionFromLineStart:pt(e,s?"first":"last"),positionFromStart:u,positionFromEnd:j}}var Ot=function(e){var t=e.defaultValue,n=void 0===t?"":t,r=(e.children,e.className),o=e.onChange,i=e.onBlur,s=(e.onError,e.linebreaks),l=e.style,u=e.placeholder,d=void 0===u?"":u,j=e.onInputRef,b=e.onGoToPrevInput,p=e.onGoToNextInput,h=e.onSplitText,O=e.onMergeToPrevInput,f=e.onMergeToNextInput,x=(Object(de.a)(e,bt),Object(c.useRef)(null)),v=Object(c.useState)(""),m=Object(a.a)(v,2),g=m[0],_=m[1],y=Object(c.useState)({__html:""}),k=Object(a.a)(y,2),w=k[0],C=k[1];Object(c.useEffect)((function(){_((function(e){return e!==n?(C((function(e){var t=n.replace(/</g,"&lt;").replace(/>/g,"&gt;");return e.__html!==t?{__html:t}:e})),n):e}))}),[n,_,C]);var F=Object(c.useCallback)((function(e){var t=e.target.innerHTML||"".replace(/&lt;/g,"<").replace(/&gt;/g,">");t=(t=!1===s?t.replace(/<\/? ?br ?\/?>/g," "):t.replace(/<\/? ?br ?\/?>/g,"\n")).trim(),_(t),o&&o(t)}),[o,_,s]),S=Object(c.useCallback)((function(){i&&i(g)}),[i,g]),I=Object(c.useCallback)((function(e){if("Enter"===e.key&&!0===e.shiftKey)!1!==s&&document.execCommand("insertLineBreak"),e.preventDefault();else if("Tab"===e.key)document.execCommand("insertText",!1,"\t"),e.preventDefault();else if("ArrowUp"===e.key){if(b){var t=ht(x.current);t.inFirstLine&&(b({caret:t}),e.preventDefault())}}else if("ArrowLeft"===e.key){if(b){var n=ht(x.current);n.inFirstLine&&n.positionFromStart<=0&&(n.positionFromLineStart=-1,b({caret:n}),e.preventDefault())}}else if("ArrowDown"===e.key){if(p){var r=ht(x.current);r.inLastLine&&(p({caret:r}),e.preventDefault())}}else if("ArrowRight"===e.key){if(p){var a=ht(x.current);a.inLastLine&&a.positionFromEnd<=1&&(a.positionFromLineStart=0,p({caret:a}),e.preventDefault())}}else if("Enter"===e.key){if(h){var c=ht(x.current),o=x.current.innerText,i=o.slice(0,c.positionFromStart),l=o.slice(c.positionFromStart);h({texts:[i,l]}),e.preventDefault()}}else if("Backspace"===e.key){if(O){var u=ht(x.current);0===u.positionFromStart&&u.inFirstLine&&(O({caret:u,text:x.current.innerText}),e.preventDefault())}}else if("Delete"===e.key&&f){var d=ht(x.current);0===d.positionFromEnd&&d.inLastLine&&(f({caret:d,text:x.current.innerText}),e.preventDefault())}}),[x,s,b,p,h,O,f]);Object(c.useEffect)((function(){j&&j(x)}),[j,x]);var E=Object(c.useCallback)((function(e){e.preventDefault();var t=(e.originalEvent||e).clipboardData.getData("text/plain");!1===s&&(t=t.replace(/\n/g," ")),document.execCommand("insertText",!1,t)}),[s]);return Object(N.jsx)("div",{ref:x,onKeyDown:I,onInput:F,onBlur:S,onPaste:E,className:"".concat(jt.a.rebuild_textarea," ").concat(0===g.length?jt.a.show_placeholder:""," ").concat(r),contentEditable:!0,dangerouslySetInnerHTML:w,style:l,placeholder:d})};var ft=function(e){var t=e.defaultBlock,n=void 0===t?{}:t,r=e.open,o=void 0!==r&&r,i=(e.onChange,e.onClose),s=Object(c.useState)(""),l=Object(a.a)(s,2),u=l[0],d=l[1],j=Object(c.useState)({}),b=Object(a.a)(j,2),p=b[0],h=b[1],O=p.trigger,f=(void 0===O?{}:O).path,x=void 0===f?"":f;Object(c.useEffect)((function(){console.log("defaultBlock",n),h(n.properties)}),[h,n]);var v=Object(c.useCallback)((function(){h((function(e){var t=Object(_.a)({},e);return""===u?(t.hasOwnProperty("trigger")&&delete t.trigger,t.hasOwnProperty("action")&&delete t.action):(t.trigger={type:"path",path:u},t.action={type:"render_block"}),t}))}),[u,h]),m=function(){var e=document.createElement("a");e.href="https://umami.qiekub.org/share/s0ZHBZbb/volt.link?url=%2F".concat(x),e.target="_blank",e.rel="noreferrer",e.click()};return o?Object(N.jsx)(at.a,{open:o,onClose:i,hideBackdrop:!0,children:Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:lt.a.backdrop,onClick:i}),Object(N.jsxs)("div",{className:lt.a.dialog,children:[Object(N.jsx)("h1",{style:{margin:"0 0 var(--basis_x4) 0"},children:"Get the link"}),Object(N.jsxs)("div",{className:lt.a.inputWrapper,children:[Object(N.jsx)(Ot,{defaultValue:x,onChange:d,linebreak:!1,className:lt.a.input}),Object(N.jsx)("button",{onClick:v,children:"Save"})]}),Object(N.jsx)("hr",{style:{opacity:.2}}),Object(N.jsx)("pre",{children:JSON.stringify(p,null,4)}),Object(N.jsx)("hr",{style:{opacity:.2}}),Object(N.jsxs)("div",{className:lt.a.actions,children:[""!==x?Object(N.jsxs)("div",{children:[Object(N.jsxs)("button",{className:"text hasIcon",onClick:function(){var e=document.createElement("a");e.href="https://qrcode.volt.link/?c=volt.link/".concat(x),e.target="_blank",e.rel="noreferrer",e.click()},style:{marginInlineStart:"0"},children:[Object(N.jsx)(ct.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",children:Object(N.jsx)(S,{id:"sharing_qrcode"})})]}),Object(N.jsxs)("button",{className:"text hasIcon",onClick:m,children:[Object(N.jsx)(ot.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",children:Object(N.jsx)(S,{id:"sharing_statistics"})})]}),Object(N.jsxs)("button",{className:"text hasIcon",onClick:m,children:[Object(N.jsx)(it.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",children:Object(N.jsx)(S,{id:"sharing_copy_url"})})]})]}):Object(N.jsx)("div",{}),Object(N.jsx)("button",{onClick:i,className:"green",style:{marginInlineEnd:"0"},children:"Done"})]})]})]})}):null},xt=n(325),vt=n(298),mt=n(299),gt=n(327),_t=["multiple","onChange","onError"],yt=/^(?:(?:(?:(?![\t-\r "\(\),\.:-<>@\[-\]\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+(?:\.(?:(?![\t-\r "\(\),\.:-<>@\[-\]\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+)*)|(?:"(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+"))@(?:(?:\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})|(?:(?:[\x2D0-9A-Za-z\u017F\u212A]+\.)+[A-Za-z\u017F\u212A]{2,})\.?)$/gi,kt=/((?:(?:(?:(?![\t-\r "\(\),\.:-<>@\[-\]\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+(?:\.(?:(?![\t-\r "\(\),\.:-<>@\[-\]\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])[\s\S])+)*)|(?:"(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+"))@(?:(?:\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})|(?:(?:[\x2D0-9A-Za-z\u017F\u212A]+\.)+[A-Za-z\u017F\u212A]{2,})\.?))/gi;var wt=function(e){var t=e.multiple,n=void 0!==t&&t,r=e.onChange,a=e.onError,o=Object(de.a)(e,_t),i=Object(c.useCallback)((function(e){if(r||a){var t=e.target.value||"",c=!1,o="";if(""!==t)if(!0===n){var i=t.match(kt);i?(t=i,c=!0):o="Invalid email(s) format"}else t.match(yt)?c=!0:o="invalid_email";r&&r(c?t:!0===n?[]:""),a&&a(o)}}),[n,r,a]);return Object(N.jsx)("input",Object(_.a)({type:"email",onChange:i},o))},Ct=n(61),Ft=n.n(Ct);function Nt(e){var t=e.role;return Object(N.jsx)(S,{id:"role-"+t})}function St(e){var t=e.role,n=e.trigger,r=e.changeRole,c=e.removePermission,i=o.a.useState(null),s=Object(a.a)(i,2),l=s[0],u=s[1],d=Boolean(l),j=function(){u(null)};return Object(N.jsxs)(N.Fragment,{children:[n({onClick:function(e){u(e.currentTarget)}}),Object(N.jsxs)(xt.a,{anchorEl:l,open:d,onClose:j,MenuListProps:{style:{maxWidth:"100%"}},children:["editor"===t?Object(N.jsxs)(Ie.a,{onClick:function(){return r("viewer")},children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(Ae.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(Nt,{role:"viewer"})})]}):Object(N.jsxs)(Ie.a,{onClick:function(){return r("editor")},children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(vt.a,{})}),Object(N.jsx)(O.a,{children:Object(N.jsx)(Nt,{role:"editor"})})]}),"function"===typeof c?Object(N.jsxs)(Ie.a,{onClick:c,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(Ye.a,{})}),Object(N.jsx)(O.a,{children:"Remove"})]}):null,Object(N.jsx)(Ee.a,{style:{opacity:.2}}),Object(N.jsxs)(Ie.a,{onClick:j,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(tt.a,{})}),Object(N.jsx)(O.a,{children:"Close"})]})]})]})}function It(e){var t=e.filter((function(e){return"owner"===e.role})).sort((function(e,t){return e.email.localeCompare(t.email)})),n=e.filter((function(e){return"@volteuropa.org"===e.email||"@public"===e.email})).sort((function(e,t){return e.email.localeCompare(t.email)})),r=e.filter((function(e){return"owner"!==e.role&&"@volteuropa.org"!==e.email&&"@public"!==e.email})).sort((function(e,t){return e.email.localeCompare(t.email)}));return[].concat(Object(Ce.a)(t),Object(Ce.a)(n),Object(Ce.a)(r))}var Et=function(e){var t=e.defaultPermissions,n=e.open,o=void 0!==n&&n,i=e.onChange,s=e.onClose,l=E().getString,u=B().email,d=void 0===u?"":u,j=Object(c.useState)(0),b=Object(a.a)(j,2),p=b[0],h=b[1],O=Object(c.useState)([]),f=Object(a.a)(O,2),x=f[0],v=f[1],m=Object(c.useState)([]),g=Object(a.a)(m,2),y=g[0],k=g[1],w=Object(c.useState)("editor"),C=Object(a.a)(w,2),F=C[0],S=C[1],I=Object(c.useCallback)((function(e){var t;""!==d&&(t=e||[],0===(e=Object(Ce.a)(t).map((function(e){var t=Object(_.a)({},e);return t.tmp_id=Object(gt.a)(),t}))).filter((function(e){return"owner"===e.role})).length&&e.unshift({tmp_id:Object(gt.a)(),email:d,role:"owner"}),v(e))}),[d,v]);Object(c.useEffect)((function(){Array.isArray(t)?I(t):I([])}),[I,t]);var A=Object(c.useCallback)((function(e){var t=x.filter((function(t){return t.email!==e}));"@volteuropa.org"===e&&(t=t.filter((function(e){return"@public"!==e.email}))),0===x.filter((function(e){return"owner"===e.role})).length&&t.unshift({tmp_id:Object(gt.a)(),email:d,role:"owner"}),v(t),i(t)}),[x,d,v,i]),D=Object(c.useCallback)((function(e,t){var n=x.map((function(n){return n.email===e?Object(_.a)(Object(_.a)({},n),{},{role:t}):n}));v(n),i(n)}),[x,v,i]),T=Object(c.useCallback)((function(e,t){e.includes("@public")&&e.push("@volteuropa.org");var n,a=x.filter((function(t){return!e.includes(t.email)})),c=Object(r.a)(e);try{for(c.s();!(n=c.n()).done;){var o=n.value;a.unshift({tmp_id:Object(gt.a)(),email:o,role:t})}}catch(s){c.e(s)}finally{c.f()}v(a),i(a)}),[x,v,i]),P=Object(c.useCallback)((function(){T(y,F),k([]),h((function(e){return e+1}))}),[y,F,T]);if(!o)return null;var L=0===x.filter((function(e){return"@volteuropa.org"===e.email})).length,R=0===x.filter((function(e){return"@public"===e.email})).length;return Object(N.jsx)(at.a,{open:o,onClose:s,hideBackdrop:!0,children:Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:Ft.a.backdrop,onClick:s}),Object(N.jsx)("div",{className:Ft.a.dialogsWrapper,children:Object(N.jsxs)("div",{className:Ft.a.dialog,children:[Object(N.jsx)("h1",{style:{margin:"0 0 var(--basis_x4) 0"},children:"Give viewing and editing rights"}),Object(N.jsxs)("p",{children:["Enter @volteuropa.org addresses to give editing rights.",Object(N.jsx)("br",{}),"Groups addresses are not supported."]}),Object(N.jsxs)("div",{className:Ft.a.inputWrapper,children:[Object(N.jsx)(he,{className:Ft.a.emailInput,children:function(e){var t=e.setError;return Object(N.jsx)(wt,{multiple:!0,onError:t,defaultValue:"",onChange:k,"aria-label":l("path_editor_permissions_edit_label"),placeholder:l("path_editor_permissions_edit_placeholder"),style:{flexGrow:"1",margin:"var(--basis) 0",width:"calc(100% - var(--basis_x2))"}})}}),Object(N.jsx)(St,{role:F,changeRole:S,trigger:function(e){return Object(N.jsxs)("button",Object(_.a)(Object(_.a)({className:Ft.a.menuButton},e),{},{children:[Object(N.jsx)(Nt,{role:F})," ",Object(N.jsx)(mt.a,{})]}))}})]},p),y.length>0&&y[0].length>0?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("hr",{}),Object(N.jsx)("div",{className:Ft.a.actions,children:Object(N.jsx)("button",{onClick:P,className:"green",style:{margin:"0"},children:y.length>1?Object(N.jsx)(N.Fragment,{children:"Add People"}):Object(N.jsx)(N.Fragment,{children:"Add Person"})})})]}):Object(N.jsxs)(N.Fragment,{children:[L||R?Object(N.jsxs)("div",{style:{marginTop:"var(--basis_x2)"},children:["Make visible for\u2026",L?Object(N.jsx)("button",{onClick:function(){return T(["@volteuropa.org"],"viewer")},children:"Volt Europa"}):null,R?Object(N.jsx)("button",{onClick:function(){return T(["@public"],"viewer")},children:"Public"}):null]}):null,0===x.length?null:Object(N.jsx)("hr",{style:{opacity:.2}}),It(x).map((function(e){return Object(N.jsxs)("div",{className:Ft.a.permissionRow,children:["@public"===e.email?Object(N.jsx)("strong",{children:"Public"}):"@volteuropa.org"===e.email?Object(N.jsx)("strong",{children:"Volt Europa"}):Object(N.jsx)("span",{children:e.email}),"owner"===e.role?Object(N.jsx)("strong",{className:"type_button ".concat(Ft.a.ownerInfo),children:Object(N.jsx)(Nt,{role:e.role})}):Object(N.jsx)(St,{role:e.role,removePermission:function(){return A(e.email)},changeRole:function(t){return D(e.email,t)},trigger:function(t){return Object(N.jsxs)("button",Object(_.a)(Object(_.a)({className:Ft.a.menuButton},t),{},{children:[Object(N.jsx)(Nt,{role:e.role})," ",Object(N.jsx)(mt.a,{})]}))}})]},e.tmp_id)})),Object(N.jsx)("hr",{style:{opacity:.2}}),Object(N.jsx)("div",{className:Ft.a.actions,children:Object(N.jsx)("button",{onClick:s,className:"green",style:{margin:"0"},children:"Done"})})]})]})})]})})},Bt=n(96),At=n.n(Bt),Dt=n(128),Tt=n.n(Dt),Pt=n.p+"static/media/20200912_Plakatschlange_Koeln_Matteo Sant_Unione_011.3f9289d0.png",Lt=n.p+"static/media/Aktion.89c1bcdf.png",Rt=n.p+"static/media/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.6824f6ef.png",Ht=n.p+"static/media/Welcome-to-Volt.39e04eca.png",Mt=["closePopover"];var Vt=I((function(e){var t=e.getString,n=e.defaultValue,r=e.onChange;return Object(N.jsx)(Re,{trigger:function(e){return Object(N.jsx)("div",{className:"".concat(Tt.a.coverphoto," ").concat(n?"":Tt.a.no_image),style:{backgroundImage:"url(".concat(n,")")},children:Object(N.jsx)("button",Object(_.a)(Object(_.a)({},e),{},{className:Tt.a.changeCoverphotoButton,children:"Set Coverphoto"}))})},children:function(e){e.closePopover;var a=Object(de.a)(e,Mt);return Object(N.jsxs)(Fe.a,Object(_.a)(Object(_.a)({},a),{},{sx:{maxWidth:"calc(calc(100vw - 32px) - var(--basis_x8))",maxHeight:"calc(calc(100vh - 32px) - var(--basis_x8))",overflow:"auto",padding:"var(--basis_x4)"},elevation:8,children:[Object(N.jsx)("h3",{children:Object(N.jsx)(S,{id:"path_editor_coverphoto_label"})}),Object(N.jsxs)("div",{children:[Object(N.jsx)("em",{className:"body2",style:{display:"block",marginBottom:"var(--basis)"},children:Object(N.jsx)(S,{id:"path_editor_coverphoto_info",vars:{width:"1200px",height:"400px",ratio:"3/1"}})}),Object(N.jsx)(he,{children:function(e){var t=e.setError;return Object(N.jsx)(ue,{onError:t,onChange:r,value:n,type:"text",style:{marginRight:"0",marginLeft:"0",width:"calc(100% - var(--basis_x2))"}})}}),Object(N.jsx)(re,{onChange:r,ariaLabel:t("path_editor_coverphoto_label"),defaultValue:n||"",items:[{value:"",title:t("path_editor_no_coverphoto")}].concat(Object(Ce.a)([{value:"https://assets.volteuropa.org/styles/scale_2880x/public/inline-images/tYADz4UyUAAcV5WlmWLlkXD9LG8W02U9LbQd8rxzQ2bt99lxwK.jpg",icon:Rt},{value:"https://assets.volteuropa.org/styles/scale_1920x/public/2020-11/Welcome-to-Volt.jpg",icon:Ht},{value:"https://assets.volteuropa.org/styles/scale_1920x/public/2021-07/20200912_Plakatschlange_Ko%CC%88ln_Matteo%20Sant_Unione_011.jpeg",icon:Pt},{value:"https://assets.volteuropa.org/styles/scale_1920x/public/2021-05/Aktion.jpeg",icon:Lt}].map((function(e){var t=e.value,n=void 0===t?"":t,r=e.icon,a=void 0===r?"":r;return{value:n,icon:Object(N.jsx)("img",{alt:"",src:a,className:"icon image"})}}))))})]})]}))}})}));function Wt(e){return Object(Ce.a)(e||[]).map((function(e){if(!e.tmp_id){var t=Object(_.a)({},e);return t.tmp_id=Object(gt.a)(),t}return e}))}var Gt=I((function(e){var t=e.getString,n=e.type,r=e.defaultProperties,o=void 0===r?{}:r,i=e.onChange,s=Object(c.useState)({}),l=Object(a.a)(s,2),u=l[0],d=l[1],j=Object(c.useCallback)((function(e,t){var n={text:"array",slug:"string",link:"string",description:"array",coverphoto:"string",imprint:"string",privacy_policy:"string",tags:"string"},r=Object(_.a)({},u);if(n.hasOwnProperty(e)){switch(n[e]){case"array":t.length>0?r[e]=t:r.hasOwnProperty(e)&&delete r[e];break;case"string":""!==t?r[e]=t:r.hasOwnProperty(e)&&delete r[e];break;default:r[e]=t}JSON.stringify(r)!==JSON.stringify(u)&&(d(r),i&&i(r))}}),[u,d,i]);return Object(c.useEffect)((function(){d(Object(_.a)(Object(_.a)({},o),{},{text:Wt(o.text||[]),description:Wt(o.description||[])}))}),[o,d]),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(Vt,{defaultValue:u.coverphoto,onChange:function(e){return j("coverphoto",e)}}),Object(N.jsxs)("div",{className:At.a.main_headline,children:[Object(N.jsx)(qe,{defaultValue:u.text,onBlur:function(e){return j("text",e)},children:function(e){return Object(N.jsx)(Ot,Object(_.a)({placeholder:t("placeholder_main_headline"),style:{margin:"0"},linebreaks:!0,className:"show_border_on_active type_h1"},e))}}),Object(N.jsx)(qe,{defaultValue:u.description,onBlur:function(e){return j("description",e)},children:function(e){return Object(N.jsx)(Ot,Object(_.a)({"aria-label":t("path_editor_description_label"),placeholder:t("path_editor_description_placeholder"),style:{margin:"0"},linebreaks:!0,className:"show_border_on_active type_text"},e))}})]}),Object(N.jsx)("div",{className:At.a.propertiesFrame,style:"page"===n||"person"===n?null:{display:"none"},children:"page"===n||"person"===n?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:At.a.properties_row,children:[Object(N.jsx)("h3",{children:Object(N.jsx)(S,{id:"path_editor_imprint_label"})}),Object(N.jsx)("div",{children:Object(N.jsx)(he,{children:function(e){var t=e.setError;return Object(N.jsx)(ue,{onError:t,onBlur:function(e){return j("imprint",e)},defaultValue:u.imprint,type:"text",style:{margin:"0",width:"calc(100% - var(--basis_x2))"},className:"show_border_on_active"})}})})]}),Object(N.jsxs)("div",{className:At.a.properties_row,children:[Object(N.jsx)("h3",{children:Object(N.jsx)(S,{id:"path_editor_privacy_policy_label"})}),Object(N.jsx)("div",{children:Object(N.jsx)(he,{children:function(e){var t=e.setError;return Object(N.jsx)(ue,{onError:t,onBlur:function(e){return j("privacy_policy",e)},defaultValue:u.privacy_policy,type:"text",style:{margin:"0",width:"calc(100% - var(--basis_x2))"},className:"show_border_on_active"})}})})]})]}):"redirect"===n?Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("div",{className:At.a.properties_row,children:[Object(N.jsx)("h3",{children:Object(N.jsx)(S,{id:"path_editor_redirect_label"})}),Object(N.jsx)(he,{children:function(e){var n=e.setError;return Object(N.jsx)(ue,{onError:n,onBlur:function(e){return j("link",e)},type:"text",placeholder:t("path_editor_redirect_placeholder"),"aria-label":t("path_editor_redirect_label"),defaultValue:u.link,style:{marginRight:"0",marginLeft:"0",width:"calc(100% - var(--basis_x2))"},className:"show_border_on_active"})}})]})}):null})]})})),Ut=n(300);var zt=I((function(e){var t=e.getString,n=e.block,r=void 0===n?{}:n,o=e.onChange,i=(e.onSaveBlock,e.onInputRef),s=e.onGoToPrevInput,l=e.onGoToNextInput,u=e.onMergeToPrevInput,d=e.onMergeToNextInput,j=(e.onAddRowAfter,r.properties||{}),b=Object(c.useState)([]),p=Object(a.a)(b,2),h=p[0],O=p[1];Object(c.useEffect)((function(){O(j.text||[])}),[j.text,O]);var f=Object(c.useCallback)((function(){o&&o(Object(_.a)(Object(_.a)({},r),{},{properties:Object(_.a)(Object(_.a)({},r.properties),{},{text:h})}))}),[o,r,h]),x=Object(c.useCallback)((function(){u&&u(r)}),[u,r]),v=Object(c.useCallback)((function(){d&&d(r)}),[d,r]);return Object(N.jsx)(qe,{defaultValue:h,onChange:O,onBlur:f,children:function(e){return Object(N.jsx)(Ot,Object(_.a)({placeholder:t("placeholder_text"),style:{margin:"0"},linebreaks:!0,className:"hide_border type_text",onInputRef:i,onGoToPrevInput:s,onGoToNextInput:l,onMergeToPrevInput:x,onMergeToNextInput:v},e))}})}));var qt=I((function(e){var t=e.getString,n=e.block,r=void 0===n?{}:n,o=e.onChange,i=e.onInputRef,s=e.onGoToPrevInput,l=e.onGoToNextInput,u=r.properties||{},d=Object(c.useState)(u.text||[]),j=Object(a.a)(d,2),b=j[0],p=j[1],h=Object(c.useState)(u.link||""),O=Object(a.a)(h,2),f=O[0],x=O[1],v=Object(c.useCallback)((function(){o&&o(Object(_.a)(Object(_.a)({},r),{},{properties:Object(_.a)(Object(_.a)({},r.properties),{},{text:b,link:f})}))}),[o,r,b,f]);return Object(N.jsxs)("div",{style:{padding:"var(--basis) 0"},children:[Object(N.jsx)(qe,{defaultValue:b,onChange:p,onBlur:v,children:function(e){return Object(N.jsx)(Ot,Object(_.a)({placeholder:t("placeholder_button"),style:{margin:"0"},linebreaks:!0,className:"hide_border type_button",onInputRef:i,onGoToPrevInput:s,onGoToNextInput:l},e))}}),Object(N.jsx)(he,{children:function(e){var n=e.setError;return Object(N.jsx)(ue,{onError:n,onChange:x,onBlur:v,type:"text",defaultValue:f,placeholder:t("path_editor_item_link_label"),style:{margin:"var(--basis) 0",width:"calc(100% - var(--basis_x2))"}})}})]})}));var Zt=I((function(e){var t=e.getString,n=e.block,r=void 0===n?{}:n,o=e.onChange,i=(e.onSaveBlock,e.onInputRef),s=e.onGoToPrevInput,l=e.onGoToNextInput,u=e.onMergeToPrevInput,d=e.onMergeToNextInput,j=(e.onAddRowAfter,r.properties||{}),b=Object(c.useState)([]),p=Object(a.a)(b,2),h=p[0],O=p[1];Object(c.useEffect)((function(){O(j.text||[])}),[j.text,O]);var f=Object(c.useCallback)((function(){o&&o(Object(_.a)(Object(_.a)({},r),{},{properties:Object(_.a)(Object(_.a)({},r.properties),{},{text:h})}))}),[o,r,h]),x=Object(c.useCallback)((function(){u&&u(r)}),[u,r]),v=Object(c.useCallback)((function(){d&&d(r)}),[d,r]);return Object(N.jsx)(qe,{defaultValue:h,onChange:O,onBlur:f,children:function(e){return Object(N.jsx)(Ot,Object(_.a)({placeholder:t("placeholder_headline"),style:{margin:"0"},linebreaks:!0,className:"hide_border type_h2",onInputRef:i,onGoToPrevInput:s,onGoToNextInput:l,onMergeToPrevInput:x,onMergeToNextInput:v},e))}})}));function $t(){return Object(N.jsx)("hr",{style:{margin:"calc(3.4 * var(--basis)) 0"}})}var Jt=n(97),Kt=n.n(Jt),Xt=["type"];function Qt(e){var t=e.type,n=void 0===t?"text":t,r=Object(de.a)(e,Xt),a=null;switch(n){case"button":a=Object(N.jsx)(qt,Object(_.a)({},r));break;case"headline":a=Object(N.jsx)(Zt,Object(_.a)({},r));break;case"divider":a=Object(N.jsx)($t,Object(_.a)({},r));break;default:a=Object(N.jsx)(zt,Object(_.a)({},r))}return a}var Yt=I((function(e){e.fluentByObject,e.getString;var t=e.defaultContentConfig,n=void 0===t?{}:t,r=e.className,o=e.onChange,i=e.reorderHandle,s=e.onRemoveRow,l=(e.actionButton,e.dataset),u=void 0===l?{}:l,d=e.addRowBefore,j=e.addRowAfter,b=(e.permissions,e.onInputRef),p=e.onGoToPrevInput,h=e.onGoToNextInput,O=e.onSplitText,f=e.onMergeToPrevInput,x=e.onMergeToNextInput,v=Q(),m=fe(),g=Object(c.useState)({_id:n.blockId||null}),y=Object(a.a)(g,2),k=y[0],w=y[1],C=k.properties||{},F="boolean"!==typeof C.active||C.active;Object(c.useEffect)((function(){1===Object.keys(k).length&&k.hasOwnProperty("_id")&&m(k._id).then((function(e){w(e)}))}),[m,w,k]);var S=Object(c.useCallback)((function(e){var t=Object(_.a)(Object(_.a)({},k),{},{type:e});v(t).then((function(e){w(e),k._id&&k._id===e._id||o({blockId:e._id})}))}),[w,k,v,o]),I=Object(c.useCallback)((function(){var e=Object(_.a)(Object(_.a)({},k),{},{properties:Object(_.a)(Object(_.a)({},k.properties),{},{active:!F})});v(e).then((function(e){w(e),k._id&&k._id===e._id||o({blockId:e._id})}))}),[k,F,v,w,o]),E=Object(c.useCallback)((function(e){JSON.stringify(e)!==JSON.stringify(k)&&v(e).then((function(e){w(e),k._id&&k._id===e._id||o({blockId:e._id})}))}),[v,k,o]);return Object(N.jsxs)("div",Object(_.a)(Object(_.a)({className:"".concat(Kt.a.block," ").concat(r)},u),{},{children:[Object(N.jsx)(rt,{block:k,setType:S,toggle_active:I,active:F,onRemoveRow:s,addRowBefore:d,addRowAfter:j,trigger:function(e){return Object(N.jsx)("div",Object(_.a)(Object(_.a)({},e),{},{className:Kt.a.reorderHandle,children:i}))}}),Object(N.jsx)("div",{className:"".concat(Kt.a.block_input," ").concat(F?Kt.a.form_active:Kt.a.form_deactivated),children:Object(N.jsx)(Qt,{type:k.type,block:k,onChange:E,onSaveBlock:E,onInputRef:b,onGoToPrevInput:p,onGoToNextInput:h,onSplitText:O,onMergeToPrevInput:f,onMergeToNextInput:x,onAddRowAfter:j})})]}))})),en=n(129),tn=n(170),nn=n.n(tn),rn=n(98),an=n.n(rn);function cn(e){e.normalize();var t=Object(Ce.a)(e.childNodes).reverse();if(t.length>0){var n=e;if(3===t[0].nodeType){var a,c=Object(r.a)(t);try{for(c.s();!(a=c.n()).done;){var o=a.value;if(3===o.nodeType)n=o;else if(1===o.nodeType)break}}catch(d){c.e(d)}finally{c.f()}}else if(t.length>1&&3===t[1].nodeType){var i,s=t.slice(1),l=Object(r.a)(s);try{for(l.s();!(i=l.n()).done;){var u=i.value;if(3===u.nodeType)n=u;else if(1===u.nodeType)break}}catch(d){l.e(d)}finally{l.f()}}return n}return e}function on(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e.focus(),window.getSelection){var r=3===t.nodeType?t.length:t.innerText.length;(-1===n||n>r)&&(n=r);var a=document.createRange();a.setStart(t,0),a.setEnd(t,n),a.collapse(!1);var c=window.getSelection();c.removeAllRanges(),c.addRange(a)}}var sn=function(e){var t=e.defaultValue,n=void 0===t?[]:t,r=e.onChange,o=Object(c.useState)([]),i=Object(a.a)(o,2),s=i[0],l=i[1],u=Object(c.useState)({}),d=Object(a.a)(u,2),j=d[0],b=d[1];Object(c.useEffect)((function(){if(0===s.length&&n.length>0){var e=(t=n,Object(Ce.a)(t).map((function(e){var t=Object(_.a)({},e);return t.tmp_id=Object(gt.a)(),t})));l(e)}var t}),[s,n,l]);var p=Object(c.useCallback)((function(e,t){var n=Object(_.a)({},j);n.hasOwnProperty(e.tmp_id)&&n[e.tmp_id]===t||(n[e.tmp_id]=t,b(n))}),[j,b]),h=Object(c.useCallback)((function(e,t){for(var n=t.caret,r=e.index,a=null,c=s.length-1;c>=0;c--){var o=s[c].tmp_id;if(c<r&&j[o]&&j[o].current){a=j[o];break}}if(a){var i=cn(a.current);on(a.current,i,n.positionFromLineStart)}}),[s,j]),O=Object(c.useCallback)((function(e,t){for(var n=t.caret,r=e.index,a=null,c=0;c<s.length;c++){var o=s[c].tmp_id;if(c>r&&j[o]&&j[o].current){a=j[o];break}}if(a){var i=function(e){e.normalize();var t=e.childNodes;return t.length>0?t[0]:e}(a.current);on(a.current,i,n.positionFromLineStart)}}),[s,j]),f=Object(c.useCallback)((function(){for(var e=null,t=s.length-1;t>=0;t--){var n=s[t].tmp_id;if(j[n]&&j[n].current){e=j[n];break}}if(e){var r=cn(e.current);on(e.current,r,-1)}}),[s,j]),x=Object(c.useCallback)((function(e,t){var n=Object(Ce.a)(s).map((function(n){return n.tmp_id===e.tmp_id?Object(_.a)(Object(_.a)({},n),t):n}));l(n),r(n)}),[s,l,r]),v=Object(c.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(n="object"===typeof n?Object(_.a)({tmp_id:Object(gt.a)()},n):n||{tmp_id:Object(gt.a)()},"number"===typeof e&&!isNaN(e)){var a=Object(Ce.a)(s);a.splice(e+t,0,n),l(a),r(a)}}),[s,l,r]),m=s.filter((function(e){return e.tmp_id}));return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{style:{position:"relative",width:"calc(1000px + var(--basis_x8))",maxWidth:"100%",margin:"var(--basis_x8) auto 0 auto"},children:[Object(N.jsx)("div",{children:Object(N.jsx)("button",{onClick:function(){return v(0,0,{})},className:"text hasIcon",style:{margin:"0 0 var(--basis_x2) 0"},children:Object(N.jsxs)("span",{style:{pointerEvents:"none"},children:[Object(N.jsx)(Ut.a,{className:"icon"}),Object(N.jsx)("span",{style:{marginInlineStart:"var(--basis_x2)",verticalAlign:"middle"},children:Object(N.jsx)(S,{id:"add_content_before"})})]})})}),Object(N.jsx)(en.a,{onDragEnd:function(e){if(e.destination&&e.destination.index!==e.source.index){var t=function(e,t,n){var r=Array.from(e),c=r.splice(t,1),o=Object(a.a)(c,1)[0];return r.splice(n,0,o),r}(s,e.source.index,e.destination.index);l(t),r(t)}},children:Object(N.jsx)(en.c,{droppableId:"list",isDropDisabled:!1,children:function(e){return Object(N.jsxs)("div",Object(_.a)(Object(_.a)({ref:e.innerRef},e.droppableProps),{},{children:[m.map((function(e,t){var n=e.tmp_id,r={index:t,tmp_id:n};return Object(N.jsx)(en.b,{draggableId:n,index:t,isDragDisabled:!1,disableInteractiveElementBlocking:!0,shouldRespectForcePress:!0,children:function(a){return Object(c.createElement)("div",Object(_.a)(Object(_.a)({ref:a.innerRef},a.draggableProps),{},{key:n,className:an.a.row}),Object(N.jsx)("div",{className:an.a.form,children:Object(N.jsx)(Yt,{className:an.a.item,dataset:{"data-index":t,"data-id":n},defaultContentConfig:e,reorderHandle:Object(N.jsx)("button",Object(_.a)(Object(_.a)({className:"text ".concat(an.a.inlineRowButton," ").concat(an.a.dragHandleButton)},a.dragHandleProps),{},{children:Object(N.jsx)(nn.a,{})})),onRemoveRow:function(){},addRowBefore:function(e){return v(t,0,e)},addRowAfter:function(e){return v(t,1,e)},onInputRef:function(e){return p(r,e)},onGoToPrevInput:function(e){return h(r,e)},onGoToNextInput:function(e){return O(r,e)},onChange:function(e){return x(r,e)}},n)}))}},n)})),e.placeholder]}))}})})]}),Object(N.jsx)("div",{style:{position:"relative",height:"50vh",cursor:0===m.length?"default":"text"},onClick:0===m.length?null:f})]})};var ln=function(){var e=E().getString,t=Q(),n=fe(),r=Ue().currentLocale,o=Object(c.useState)(!1),i=Object(a.a)(o,2),s=i[0],l=i[1],u=Object(c.useCallback)((function(){return l(!0)}),[l]),j=Object(c.useCallback)((function(){return l(!1)}),[l]),b=Object(c.useState)(!1),p=Object(a.a)(b,2),h=p[0],O=p[1],f=Object(c.useCallback)((function(){return O(!0)}),[O]),x=Object(c.useCallback)((function(){return O(!1)}),[O]),v=Object(c.useRef)(!1),m=Object(d.g)().id,g=void 0===m?"":m,y=Object(c.useState)({type:"page",properties:{},content:[]}),k=Object(a.a)(y,2),w=k[0],C=k[1],F=w.type,I=w.properties,B=w.content,A=w.permissions;Object(c.useEffect)((function(){"string"!==typeof g||""===g||v.current&&g===w._id||n(g).then((function(e){v.current=!0,C(e)}))}),[g,w,n,C]);var D=Object(c.useCallback)((function(e){if(e!==w.type){var n=Object(_.a)(Object(_.a)({},w),{},{type:e});t(n).then((function(e){C(e)}))}}),[w,t,C]),T=Object(c.useCallback)((function(e){if(e!==w.properties){var n=Object(_.a)(Object(_.a)({},w),{},{properties:e});t(n).then((function(e){C(e)}))}}),[w,t,C]),P=Object(c.useCallback)((function(e){if(e!==w.content){var n=Object(_.a)(Object(_.a)({},w),{},{content:e});t(n).then((function(e){C(e)}))}}),[w,t,C]),L=Object(c.useCallback)((function(e){if(e!==w.permissions){var n=Object(_.a)(Object(_.a)({},w),{},{permissions:e});t(n).then((function(e){C(e)}))}}),[w,t,C]),R=Object(c.useCallback)((function(){t(w).then((function(e){e._id!==w._id&&C(e)}))}),[t,w,C]),H=Object(N.jsxs)("div",{className:"buttonRow",style:{whiteSpace:"nowrap"},children:[Object(N.jsx)(ze,{trigger:function(t){return Object(N.jsxs)("button",Object(_.a)(Object(_.a)({},t),{},{className:"text hasIcon",children:[Object(N.jsx)(xe.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",style:{verticalAlign:"middle"},children:e("locale_"+r)})]}))}}),s?Object(N.jsx)(ft,{defaultBlock:w,open:s,onClose:j,onChange:L}):null,Object(N.jsxs)("button",{className:"text hasIcon",onClick:u,children:[Object(N.jsx)(ve.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",style:{verticalAlign:"middle"},children:Object(N.jsx)(S,{id:"path_editor_share"})})]}),h?Object(N.jsx)(Et,{defaultPermissions:A,open:h,onClose:x,onChange:L}):null,Object(N.jsxs)("button",{className:"text hasIcon",onClick:f,children:[Object(N.jsx)(me.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",style:{verticalAlign:"middle"},children:Object(N.jsx)(S,{id:"path_editor_permissions"})})]}),Object(N.jsxs)("button",{className:"text hasIcon",onClick:R,children:[Object(N.jsx)(ge.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",style:{verticalAlign:"middle"},children:Object(N.jsx)(S,{id:"path_editor_save"})})]}),Object(N.jsx)(rt,{block:w,setType:D,trigger:function(e){return Object(N.jsx)("button",Object(_.a)(Object(_.a)({},e),{},{className:"white hasIcon",children:Object(N.jsx)(_e.a,{className:"icon"})}))}})]});return Object(N.jsxs)("div",{className:"hasHeader ".concat(we.a.editor),children:[Object(N.jsx)(ne,{title:Object(N.jsx)(Y.b,{to:"/",children:Object(N.jsx)("button",{className:"text hasIcon",style:{margin:"0"},children:Object(N.jsx)(ye.a,{className:"icon"})})},w._id),rightActions:H}),Object(N.jsx)(Gt,{type:F,defaultProperties:I,onChange:T}),Object(N.jsx)(sn,{onChange:P,defaultValue:B})]})};var un=function(){var e=Object(U.a)();return Object(c.useCallback)((function(t){return new Promise((function(n){Array.isArray(t)||t.length>0?e.query({query:J,variables:{ids:t}}).then(function(){var e=Object(M.a)(H.a.mark((function e(t){var r;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"string"!==typeof(r=t.data).error&&r.blocksByIds?n(r.blocksByIds):(console.error(r.error),n([]));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=Object(M.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.error("error",t),n([]);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):n([])}))}),[e])};var dn=function(e){var t=e.block,n=(0,E().fluentByAny)(t.properties.text,"");return Object(N.jsx)("h2",{dir:"auto",children:n})};var jn=function(e){var t=e.block,n=(0,E().fluentByAny)(t.properties.text,"");return Object(N.jsx)("p",{dir:"auto",children:n})};var bn=function(e){var t=e.block,n=(0,E().fluentByAny)(t.properties.text,"");return Object(N.jsx)("button",{dir:"auto",style:{marginLeft:"0",marginRight:"0"},children:n})};function pn(){return Object(N.jsx)("hr",{})}var hn=n(79),On=n.n(hn),fn=n(307);var xn=function(){var e=Object(c.useRef)(!1),t=B().loggedIn,n=fe(),r=un(),o=E().fluentByAny,i=Object(d.g)().id,s=void 0===i?"":i,l=Object(c.useState)({type:"page",properties:{},content:[]}),u=Object(a.a)(l,2),j=u[0],b=u[1],p=Object(c.useState)([]),h=Object(a.a)(p,2),O=h[0],f=h[1];Object(c.useEffect)((function(){!1===e.current&&"string"===typeof s&&""!==s&&(e.current=!0,n(s).then((function(t){b(t);var n=t.content.map((function(e){return e.blockId}));console.log("ids",n),r(n).then((function(t){var r=Object(Ce.a)(n).map((function(e){return t.find((function(t){return t._id===e}))}));f(Object(Ce.a)(r)),e.current=!1}))})))}),[s,n,b,r,f]);var x=o(j.properties.text,""),v=o(j.properties.description,""),m=j.properties.coverphoto||"",g=j.properties.icon||"",_=Object(N.jsx)(Y.b,{to:"/",children:Object(N.jsx)("button",{className:"text hasIcon",style:{margin:"0"},children:Object(N.jsx)(ye.a,{className:"icon"})})}),y=Object(N.jsx)("div",{className:"buttonRow",style:{whiteSpace:"nowrap"},children:Object(N.jsx)(Y.b,{to:"/edit/".concat(j._id),children:Object(N.jsxs)("button",{className:"text hasIcon",children:[Object(N.jsx)(fn.a,{className:"icon"}),Object(N.jsx)("span",{className:"hideOnSmallScreen",style:{verticalAlign:"middle"},children:Object(N.jsx)(S,{id:"edit_block"})})]})})});return Object(N.jsxs)(N.Fragment,{children:[t?Object(N.jsx)(ne,{leftActions:_,title:"",rightActions:y}):null,Object(N.jsxs)("div",{className:"basis_x1 ".concat(On.a.app," ").concat(On.a.spine_aligned),dir:"auto",children:[""!==m?Object(N.jsx)("div",{style:{backgroundImage:"url(".concat(m,")")},className:On.a.coverphoto}):null,Object(N.jsxs)("main",{className:"".concat(On.a.contentWrapper),children:[""!==g?Object(N.jsx)("div",{style:{backgroundImage:"url(".concat(g,")")},className:On.a.icon}):null,""!==x?Object(N.jsx)("h1",{dir:"auto",children:x}):null,""!==v?Object(N.jsxs)("p",{dir:"auto",children:[v.split(/\n/g).flatMap((function(e){return[e,Object(N.jsx)("br",{})]})),Object(N.jsx)("br",{})]}):null,Object(N.jsx)("div",{className:On.a.items,children:O.map((function(e){var t=null;switch(e.type){case"headline":t=Object(N.jsx)(dn,{block:e},e._id);break;case"text":t=Object(N.jsx)(jn,{block:e},e._id);break;case"button":t=Object(N.jsx)(bn,{block:e},e._id);break;case"divider":t=Object(N.jsx)(pn,{block:e},e._id);break;default:t=null}return Object(N.jsx)("div",{children:t})}))})]})]})]})};var vn=I((function(e){e.getString;var t=B().loggedIn,n=Object(c.useState)(!1),r=Object(a.a)(n,2),o=r[0],i=r[1],s=Object(c.useCallback)((function(){i((function(e){return!e}))}),[i]),l="undefined"!==typeof navigator&&/iPad|iPhone|iPod/.test(navigator.userAgent),_=Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("button",{onClick:s,className:"text hasIcon",style:{margin:"0"},children:Object(N.jsx)(f.a,{className:"icon"})}),Object(N.jsx)(j.a,{anchor:"left",open:o,onOpen:s,onClose:s,disableBackdropTransition:!l,disableDiscovery:l,children:Object(N.jsxs)(b.a,{style:{maxWidth:"100%"},children:[Object(N.jsx)("a",{href:"mailto:thomas.rosen@volteuropa.org",children:Object(N.jsxs)(p.a,{button:!0,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(x.a,{})}),Object(N.jsx)(O.a,{primary:Object(N.jsx)(S,{id:"contact"})})]})}),Object(N.jsx)("a",{href:"https://github.com/voltbonn/edit.volt.link",target:"_blank",rel:"noopener noreferrer",children:Object(N.jsxs)(p.a,{button:!0,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(v.a,{})}),Object(N.jsx)(O.a,{primary:Object(N.jsx)(S,{id:"source_code"})})]})}),Object(N.jsx)("br",{}),t?Object(N.jsx)("a",{href:"".concat(window.domains.backend,"logout?redirect_to=").concat(encodeURIComponent(window.location.toString())),children:Object(N.jsxs)(p.a,{button:!0,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(m.a,{})}),Object(N.jsx)(O.a,{primary:Object(N.jsx)(S,{id:"logout"})})]})}):Object(N.jsx)("a",{href:"".concat(window.domains.backend,"login?redirect_to=").concat(encodeURIComponent(window.location.toString())),children:Object(N.jsxs)(p.a,{button:!0,children:[Object(N.jsx)(h.a,{children:Object(N.jsx)(g.a,{})}),Object(N.jsx)(O.a,{primary:Object(N.jsx)(S,{id:"login"})})]})})]})})]});return Object(N.jsx)(N.Fragment,{children:Object(N.jsx)("div",{className:u.a.app,children:t?Object(N.jsxs)(d.c,{children:[Object(N.jsx)(d.a,{path:"/view/:id",children:Object(N.jsx)(xn,{leftHeaderActions:_})}),Object(N.jsx)(d.a,{path:"/edit/:id",children:Object(N.jsx)(ln,{leftHeaderActions:_})}),Object(N.jsx)(d.a,{path:"/shortcode",children:Object(N.jsx)(Oe,{leftHeaderActions:_})}),Object(N.jsx)(d.a,{path:"/",children:Object(N.jsx)(ae,{leftHeaderActions:_})})]}):Object(N.jsxs)(d.c,{children:[Object(N.jsx)(d.a,{path:"/view/:id",children:Object(N.jsx)(xn,{leftHeaderActions:_})}),Object(N.jsxs)(d.a,{path:"/",children:[Object(N.jsx)("h1",{children:"Login to view content"}),Object(N.jsx)("a",{href:"".concat(window.domains.backend,"login?redirect_to=").concat(encodeURIComponent(window.location.toString())),children:Object(N.jsxs)("button",{className:"hasIcon",style:{margin:"var(--basis_x4) 0 0 0"},children:[Object(N.jsx)(g.a,{className:"icon"}),Object(N.jsx)("span",{children:Object(N.jsx)(S,{id:"login"})})]})})]})]})})})})),mn=(n(207),n(15)),gn=n(111),_n={de:"Deutsch",en:"English",fr:"Fran\xe7ais"},yn=Object.keys(_n),kn="en";function wn(e){return Cn.apply(this,arguments)}function Cn(){return(Cn=Object(M.a)(H.a.mark((function e(t){var r,a,c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(211)("./"+t+".ftl");case 2:return r=e.sent,e.next=5,fetch(r.default);case 5:return a=e.sent,e.next=8,a.text();case 8:return c=e.sent,e.abrupt("return",Object(mn.a)({},t,new gn.b(c)));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fn(e){return Nn.apply(this,arguments)}function Nn(){return(Nn=Object(M.a)(H.a.mark((function e(t){var n,a;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(wn));case 2:return n=e.sent,a=n.reduce((function(e,t){return Object.assign(e,t)})),e.abrupt("return",H.a.mark((function e(){var n,c,o,i;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(r.a)(t),e.prev=1,n.s();case 3:if((c=n.n()).done){e.next=11;break}return o=c.value,(i=new gn.a(o)).addResource(a[o]),e.next=9,i;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Sn(e){var t=e.userLocales,n=e.children,r=e.onLocaleChange,o=Object(c.useState)(function(){var e=new gn.a("");return e.addResource(new gn.b("")),new y.c([e])}()),i=Object(a.a)(o,2),s=i[0],l=i[1];return Object(c.useEffect)((function(){function e(){return(e=Object(M.a)(H.a.mark((function e(){var n,a,c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(k.negotiateLanguages)(t,yn,{defaultLocale:kn}),r&&r(n),e.next=4,Fn(n);case 4:a=e.sent,(c=new y.c(a())).userLocales=t,c.defaultLocale=kn,c.supportedLocales=yn,l(c);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,r]),s?Object(N.jsx)(y.a,{l10n:s,children:n}):Object(N.jsx)("div",{children:"Loading texts\u2026"})}var In=n(316),En=n(172),Bn=n(329),An=n(319),Dn=n(321),Tn=n(317);window.domains={frontend:"https://beta.volt.link",backend:"https://api.volt.link/"};var Pn=new An.a({uri:window.domains.backend+"graphql/v1/",cache:new Dn.a,defaultOptions:{watchQuery:{fetchPolicy:"cache-and-network"}}});function Ln(){var e=Object(c.useState)(navigator.languages),t=Object(a.a)(e,2),n=t[0],i=t[1],s=Object(c.useState)(null),l=Object(a.a)(s,2),u=l[0],d=l[1];Object(c.useEffect)((function(){if(window.umami){var e=navigator.languages;if(e||Array.isArray(e)){var t,n=Object(r.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,c=(a=a.toLowerCase()).split("-")[0];c!==a&&window.umami.trackEvent("L: "+c),window.umami.trackEvent("L: "+a)}}catch(o){n.e(o)}finally{n.f()}}}}),[]);var j=Object(c.useCallback)((function(e){i([e.target.dataset.locale])}),[i]),b=Object(c.useCallback)((function(e){d(e.length>0?e[0]:"")}),[d]),p=Object(In.a)("(prefers-color-scheme: dark)"),h=o.a.useMemo((function(){return Object(En.a)({palette:{mode:p?"dark":"light"}})}),[p]);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{id:"react-notification",style:{zIndex:"10000"}},"react-notification"),Object(N.jsx)(Sn,{userLocales:n,onLocaleChange:b,children:Object(N.jsx)(Tn.a,{client:Pn,children:Object(N.jsx)(Bn.a,{theme:h,children:Object(N.jsx)(X.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},domRoot:document.getElementById("react-notification"),children:Object(N.jsx)(Ge,{children:Object(N.jsx)(vn,{locales:_n,currentLocale:u,onLanguageChange:j})})})})})},"AppLocalizationProvider")]})}s.a.render(Object(N.jsx)(Y.a,{children:Object(N.jsx)(Ln,{})}),document.getElementById("root"))},61:function(e,t,n){e.exports={dialogsWrapper:"PermissionsEditor_dialogsWrapper__1xVvi",dialog:"PermissionsEditor_dialog__2rpyk",backdrop:"PermissionsEditor_backdrop__1dRPN",inputWrapper:"PermissionsEditor_inputWrapper__4DGsr",emailInput:"PermissionsEditor_emailInput__1uH8s",permissionRow:"PermissionsEditor_permissionRow__2HaWO",menuButton:"PermissionsEditor_menuButton__2jIMI",ownerInfo:"PermissionsEditor_ownerInfo__EEKXP",actions:"PermissionsEditor_actions__k4oBn"}},79:function(e,t,n){e.exports={app:"Viewer_app__1_jMF",spine_aligned:"Viewer_spine_aligned__2mJuq",coverphoto:"Viewer_coverphoto__16R-U",icon:"Viewer_icon__219E5",contentWrapper:"Viewer_contentWrapper__1HLN8",items:"Viewer_items__2FgjF"}},95:function(e,t,n){e.exports={dialog:"SharingEditor_dialog__22jfY",backdrop:"SharingEditor_backdrop__1Gra9",inputWrapper:"SharingEditor_inputWrapper__1UyBD",input:"SharingEditor_input__brkXK",actions:"SharingEditor_actions__2zz6x"}},96:function(e,t,n){e.exports={main_headline:"PropertiesEditor_main_headline__3wy7R",propertiesFrame:"PropertiesEditor_propertiesFrame__1uBEz",properties_row:"PropertiesEditor_properties_row__2tX7M"}},97:function(e,t,n){e.exports={block:"InlineEditorBlock_block__14-zd",block_input:"InlineEditorBlock_block_input__2I1iu",form_deactivated:"InlineEditorBlock_form_deactivated__2oktp",form_active:"InlineEditorBlock_form_active__hi5HC",reorderHandle:"InlineEditorBlock_reorderHandle__2_s23"}},98:function(e,t,n){e.exports={row:"ContentEditor_row__JonRI",form:"ContentEditor_form__wtoB9",item:"ContentEditor_item__3U0XE",inlineRowButton:"ContentEditor_inlineRowButton__2pw6r",dragHandleButton:"ContentEditor_dragHandleButton__1Y_RP"}}},[[212,1,2]]]);
//# sourceMappingURL=main.2cdc1698.chunk.js.map